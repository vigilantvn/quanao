<?php

function changeTitle($str,$strSymbol='-',$case=MB_CASE_LOWER){// MB_CASE_UPPER / MB_CASE_TITLE / MB_CASE_LOWER
	$str=trim($str);
	if ($str=="") return "";
	$str =str_replace('"','',$str);
	$str =str_replace("'",'',$str);
	$str = stripUnicode($str);
	$str = mb_convert_case($str,$case,'utf-8');
	$str = preg_replace('/[\W|_]+/',$strSymbol,$str);
	return $str;
}

function stripUnicode($str){
	if(!$str) return '';
	//$str = str_replace($a, $b, $str);
	$unicode = array(
		'a'=>'||?||?|?|?|?|?|?|?||?|?|?|?|?||||?|?|?|?',
		'A'=>'||?||?|?|?|?|?|?|?||?|?|?|?|?||||?|?|?|?',
		'ae'=>'?',
		'AE'=>'?',
		'c'=>'?||?|?|?',
		'C'=>'?|?|?|?|?',
		'd'=>'?|?',
		'D'=>'?|?',
		'e'=>'||?|?|?||?|?|?|?|?||?|?|?|?',
		'E'=>'||?|?|?||?|?|?|?|?||?|?|?|?',
		'f'=>'',
		'F'=>'',
		'g'=>'?|?|?|?',
		'G'=>'?|?|?|?',
		'h'=>'?|?',
		'H'=>'?|?',
		'i'=>'||?|?|?|||?|?|?|?|?',
		'I'=>'||?|?|?|||?|?|?|?|?',
		'ij'=>'?',
		'IJ'=>'?',
		'j'=>'?',
		'J'=>'?',
		'k'=>'?',
		'K'=>'?',
		'l'=>'?|?|?|?|?',
		'L'=>'?|?|?|?|?',
		'o'=>'||?||?||?|?|?|?|?|?|?|?|?|?|?|||?|?|?|?|?',
		'O'=>'||?||?||?|?|?|?|?|?|?|?|?|?|?|||?|?|?|?|?',
		'Oe'=>'',
		'OE'=>'',
		'n'=>'|?|?|?|?',
		'N'=>'|?|?|?',
		'u'=>'||?|?|?|?|?|?|?|?|?||?|?||?|?|?|?|?|?|?|?',
		'U'=>'||?|?|?|?|?|?|?|?|?||?|?||?|?|?|?|?|?|?|?',
		's'=>'?|?|?',
		'R'=>'?|?|?',
		's'=>'|?|?|?|?|',
		'S'=>'?|?|?|',
		't'=>'?|?|?',
		'T'=>'?|?|?',
		'w'=>'?',
		'W'=>'?',
		'y'=>'|?|?|?|?||?',
		'Y'=>'|?|?|?|?||?',
		'z'=>'?|?|',
		'Z'=>'?|?|'
	);
	foreach($unicode as $khongdau=>$codau) {
		$arr=explode("|",$codau);
		$str = str_replace($arr,$khongdau,$str);
	}
	return $str;
}
function sanitizeTitle($string) {
    if(!$string) return false;
    $utf8 = array(
            'a'=>'||?||?|?|?|?|?|?|?||?|?|?|?|?|||?||?|?|?|?|?|?|?||?|?|?|?|?',
            'd'=>'?|?',
            'e'=>'||?|?|?||?|?|?|?|?|||?|?|?||?|?|?|?|?',
            'i'=>'||?|?|?|||?|?|?',
            'o'=>'||?||?||?|?|?|?|?|?|?|?|?|?|?|||?||?||?|?|?|?|?|?|?|?|?|?|?',
            'u'=>'||?|?|?|?|?|?|?|?|?|||?|?|?|?|?|?|?|?|?',
            'y'=>'|?|?|?|?||?|?|?|?',
            );
    foreach($utf8 as $ascii=>$uni) $string = preg_replace("/($uni)/i",$ascii,$string);
    $string = utf8Url($string);
    return $string;
}

function utf8Url($string){
    $string = strtolower($string);
    $string = str_replace( "", "ss", $string);
    $string = str_replace( "%", "", $string);
    $string = preg_replace("/[^_a-zA-Z0-9 -]/", "",$string);
    $string = str_replace(array('%20', ' '), '-', $string);
    $string = str_replace("----","-",$string);
    $string = str_replace("---","-",$string);
    $string = str_replace("--","-",$string);
    return $string;
}

?>